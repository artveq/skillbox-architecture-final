# 9. Анализ и список нефункциональных требований

Нефункциональные требования сгруппированы по аттрибутам качества. Важность их для системы указана в списке аттрибутов.

## 1. Производительность (Performance)

### API
- Время отклика для основных операций (профиль, лента, рекомендации): **≤ 200 мс** (p95).
- Время отклика для тяжёлых операций (поиск, аналитика): **≤ 500 мс** (p95).
- Пропускная способность External API Gateway: **≥ 10 000 RPS** на регион.

### Телеметрия
- Задержка обработки телеметрии: **≤ 2 секунд** от устройства до записи в хранилище.
- Потеря телеметрии: **≤ 0.01%**.

### Лента активности
- Время генерации ленты: **≤ 150 мс** (p95).
- Обновление ленты после события: **≤ 1 секунда**.

### Массовые челленджи
- Поддержка **до 100 000 участников** в одном событии.
- Пересчёт рейтингов: **≤ 5 секунд** после поступления события.

## 2. Масштабируемость (Scalability)

### Горизонтальное масштабирование
- Все stateless-сервисы должны масштабироваться линейно: **увеличение RPS ×2 → увеличение инстансов ×2**.
- Event Bus должен поддерживать **до 50 000 событий/сек** на регион.

### Хранилища
- Рост данных телеметрии: **до 1 ТБ/день** на глобальную платформу.
- Рост социального графа: **до 10 млн связей/месяц**.

### IoT
- Поддержка **до 200 000 активных устройств** одновременно.

## 3. Надёжность и отказоустойчивость (Reliability & Resilience)

### Доступность
- Ключевые сервисы (Training, User, Social): **99.9%+**.
- API Gateway: **99.95%**.
- Event Bus: **99.9%**.

### Устойчивость
- Время восстановления после сбоя (RTO): **≤ 5 минут**.
- Максимально допустимая потеря данных (RPO): **≤ 30 секунд**.
- Очереди должны обеспечивать ретраи в течение **до 24 часов**.

### Деградация
- При перегрузке отключаются некритичные функции (рекомендации, промо) без влияния на тренировки.


## 4. Наблюдаемость (Observability)

### Логи
- 100% сервисов должны отправлять структурированные логи в централизованное хранилище.
- Время доставки логов: **≤ 10 секунд**.

### Метрики
- Сбор метрик с частотой **1 раз в 10 секунд**.
- SLA/SLO мониторинг по p95/p99 задержкам.

### Трассировка
- 100% запросов через API Gateway должны иметь trace-id.
- 80% внутренних запросов должны быть трассируемыми.

### Алерты
- Время реакции на критичный инцидент: **≤ 5 минут**.


## 5. Безопасность (Security)

### Доступ
- 100% сервисов должны использовать mTLS.
- Авторизация — через IAM с обновлением токенов каждые **60 минут**.

### Шифрование
- Данные в движении: TLS 1.2+.
- Данные в покое: AES-256.

### Аудит
- Логи аудита должны храниться **не менее 1 года**.
- Время записи события аудита: **≤ 5 секунд**.

### Защита от мошенничества
- Аномалии в челленджах должны выявляться в течение **≤ 10 секунд**.


## 6. Соответствие требованиям (Compliance)

### GDPR / локальные законы
- Региональное хранение данных: 100% пользовательских данных остаются в регионе.
- Удаление данных пользователя: **≤ 30 дней**.

### Минимизация данных
- Хранение телеметрии в «горячем» виде: **≤ 90 дней**.
- Архивация в холодное хранилище: **до 3 лет**.


## 7. Интероперабельность (Interoperability)

### API
- 100% API должны иметь OpenAPI-контракты.
- Совместимость версий: поддержка **минимум 2 активных версий API**.

### Интеграции
- Время ответа e-commerce интеграции: **≤ 300 мс**.
- IoT Gateway должен поддерживать **до 10 протоколов** (BLE, MQTT, HTTPS и др.).


## 8. Сопровождаемость (Maintainability)

### Код и сервисы
- Время развёртывания нового релиза: **≤ 15 минут**.
- Rollback: **≤ 10 минут**.
- Независимые релизы для всех доменных сервисов.

### Документация
- Обновление API-контрактов — **до релиза**, не позже.
